<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>中华数学之道 - 函数图像</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* 函数图像绘制区域样式 */
   .function-plotter {
      margin: 2rem 0;
      padding: 1rem;
      background-color: rgba(255, 255, 255, 0.95);
      border-radius: 8px;
      box-shadow: var(--shadow);
    }
    
   .plotter-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      flex-wrap: wrap;
      gap: 1rem;
    }
    
   .function-input-group {
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
    }
    
   .function-input {
      padding: 0.5rem 1rem;
      border: 1px solid var(--primary);
      border-radius: 4px;
      width: 250px;
      font-size: 1rem;
    }
    
   .plot-button {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 0.5rem 1.2rem;
      border-radius: 4px;
      cursor: pointer;
      transition: var(--transition);
    }
    
   .plot-button:hover {
      background-color: #144b6d;
      transform: translateY(-2px);
    }
    
   .canvas-container {
      position: relative;
      width: 100%;
      height: 500px;
      overflow: hidden;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    
    #functionCanvas {
      width: 100%;
      height: 100%;
    }
    
   .function-list {
      margin-top: 1rem;
      padding: 1rem;
      background-color: var(--light);
      border-radius: 4px;
    }
    
   .function-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px dashed #ddd;
    }
    
   .remove-function {
      color: var(--accent);
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <!-- 龙纹背景 -->
  <div class="dragon-bg"></div>

  <!-- 主容器 -->
  <div class="container">
    <!-- 标题与太极 -->
    <header>
      <div class="taiji-icon" onclick="toggleMenu()"></div>
      <h1>中华数学<span class="highlight">十维</span>之道</h1>
      <p>从太极到微积分 · 守正创新</p>
    </header>
    
    <!-- 引入MathJax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- 函数图像绘制区域 -->
    <div class="function-plotter">
      <div class="plotter-header">
        <h2>函数图像绘制</h2>
        <div class="function-input-group">
          <input type="text" class="function-input" id="functionInput" placeholder="输入函数，例如：sin(x)、x^2、cos(x)" value="sin(x)">
          <button class="plot-button" onclick="plotFunction()">绘制函数</button>
        </div>
      </div>
      <div class="canvas-container">
        <canvas id="functionCanvas"></canvas>
      </div>
      <div class="function-list" id="functionList">
        <h3>已绘制函数</h3>
        <!-- 函数列表将在这里动态生成 -->
      </div>
    </div>

    <!-- 1-10数字导航 -->
    <div class="number-grid">
      <div class="number-card" onclick="openSection('yi')">
        <div class="number">壹</div>
        <h3>太极</h3>
        <p>函数之本源</p>
      </div>
      <div class="number-card" onclick="openSection('er')">
        <div class="number">贰</div>
        <h3>两仪</h3>
        <p>微分与积分</p>
      </div>
      <div class="number-card" onclick="openSection('san')">
        <div class="number">叁</div>
        <h3>三才</h3>
        <p>定义域、值域、对应法则</p>
      </div>
      <div class="number-card" onclick="openSection('si')">
        <div class="number">肆</div>
        <h3>四象</h3>
        <p>函数四种表示法</p>
      </div>
      <div class="number-card" onclick="openSection('wu')">
        <div class="number">伍</div>
        <h3>五行</h3>
        <p>五种基本运算</p>
      </div>
      <div class="number-card" onclick="openSection('liu')">
        <div class="number">陆</div>
        <h3>六合</h3>
        <p>函数六大性质</p>
      </div>
      <div class="number-card" onclick="openSection('qi')">
        <div class="number">柒</div>
        <h3>七星</h3>
        <p>七类基本初等函数</p>
      </div>
      <div class="number-card" onclick="openSection('ba')">
        <div class="number">捌</div>
        <h3>八卦</h3>
        <p>八种函数关系</p>
      </div>
      <div class="number-card" onclick="openSection('jiu')">
        <div class="number">玖</div>
        <h3>九宫</h3>
        <p>数学知识九宫布局</p>
      </div>
      <div class="number-card" onclick="openSection('shi')">
        <div class="number">拾</div>
        <h3>十全</h3>
        <p>应用之圆满</p>
      </div>
    </div>

    <!-- 内容区 - 太极（壹） -->
    <section id="yi" class="content-section">
      <h2>壹 · 太极</h2>
      <img src="images/taiji.png" alt="太极图" class="float-right">
      <p>在中华数学之道中，函数 <code>f(x)</code> 被视为如同太极一般的存在。太极是宇宙万物未分化的整体，蕴含着无尽的可能性与变化规律，尚未呈现出阴阳分明的状态。而函数在初始阶段，同样是一个抽象的、包含着各种潜在变化的数学对象，其自变量 <code>x</code> 的每一个取值，都可能对应着因变量 <code>f(x)</code> 的不同结果，就如同太极中阴阳相互交融，随时可依据一定条件展现出不同的形态。</p>
      <p>从哲学角度看，"易有太极，是生两仪"，太极作为根源，衍生出了后续丰富多样的世界。在数学里，函数亦是众多数学概念与理论的源头，后续的微分、积分，函数的各种性质研究等，皆建立在函数这一基础之上，它是开启数学分析大门的钥匙。</p>
      <div class="quote">
        <p>"易有太极，是生两仪" ——《周易》</p>
      </div>
    </section>

    <!-- 其他内容区省略 -->
  </div>

  <script>
    // 函数绘制相关变量
    const canvas = document.getElementById('functionCanvas');
    const ctx = canvas.getContext('2d');
    let functions = [];
    const colors = ['#1a5e8c', '#e67e22', '#c0392b', '#27ae60', '#8e44ad', '#2980b9', '#f39c12'];
    
    // 设置Canvas尺寸
    function resizeCanvas() {
      const container = canvas.parentElement;
      canvas.width = container.clientWidth;
      canvas.height = container.clientHeight;
      redrawAllFunctions();
    }
    
    // 初始化时调整尺寸
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
    
    // 绘制坐标轴
    function drawAxes() {
      const width = canvas.width;
      const height = canvas.height;
      const centerX = width / 2;
      const centerY = height / 2;
      
      // 清除画布
      ctx.clearRect(0, 0, width, height);
      
      // 绘制网格
      ctx.strokeStyle = '#eee';
      ctx.lineWidth = 1;
      
      // 水平线
      for (let y = 0; y < height; y += 50) {
        ctx.beginPath();
        ctx.moveTo(0, y);
        ctx.lineTo(width, y);
        ctx.stroke();
      }
      
      // 垂直线
      for (let x = 0; x < width; x += 50) {
        ctx.beginPath();
        ctx.moveTo(x, 0);
        ctx.lineTo(x, height);
        ctx.stroke();
      }
      
      // 绘制坐标轴
      ctx.strokeStyle = '#333';
      ctx.lineWidth = 2;
      
      // X轴
      ctx.beginPath();
      ctx.moveTo(0, centerY);
      ctx.lineTo(width, centerY);
      ctx.stroke();
      
      // Y轴
      ctx.beginPath();
      ctx.moveTo(centerX, 0);
      ctx.lineTo(centerX, height);
      ctx.stroke();
      
      // 绘制箭头
      drawArrow(width - 5, centerY, 0, -10); // X轴箭头
      drawArrow(width - 5, centerY, 0, 10);
      drawArrow(centerX, 5, -10, 0); // Y轴箭头
      drawArrow(centerX, 5, 10, 0);
      
      // 绘制刻度和标签
      drawTicksAndLabels();
    }
    
    // 绘制箭头
    function drawArrow(x, y, dx, dy) {
      ctx.beginPath();
      ctx.moveTo(x, y);
      ctx.lineTo(x + dx, y + dy);
      ctx.stroke();
    }
    
    // 绘制刻度和标签
    function drawTicksAndLabels() {
      const width = canvas.width;
      const height = canvas.height;
      const centerX = width / 2;
      const centerY = height / 2;
      const scale = 50; // 每50像素代表1个单位
      
      ctx.font = '12px Arial';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'top';
      
      // X轴刻度和标签
      for (let x = centerX; x < width; x += scale) {
        const value = Math.round((x - centerX) / scale);
        ctx.beginPath();
        ctx.moveTo(x, centerY - 5);
        ctx.lineTo(x, centerY + 5);
        ctx.stroke();
        ctx.fillText(value, x, centerY + 8);
      }
      
      for (let x = centerX; x > 0; x -= scale) {
        const value = Math.round((x - centerX) / scale);
        ctx.beginPath();
        ctx.moveTo(x, centerY - 5);
        ctx.lineTo(x, centerY + 5);
        ctx.stroke();
        ctx.fillText(value, x, centerY + 8);
      }
      
      // Y轴刻度和标签
      ctx.textAlign = 'right';
      ctx.textBaseline = 'middle';
      
      for (let y = centerY; y < height; y += scale) {
        const value = Math.round((centerY - y) / scale);
        ctx.beginPath();
        ctx.moveTo(centerX - 5, y);
        ctx.lineTo(centerX + 5, y);
        ctx.stroke();
        ctx.fillText(value, centerX - 8, y);
      }
      
      for (let y = centerY; y > 0; y -= scale) {
        const value = Math.round((centerY - y) / scale);
        ctx.beginPath();
        ctx.moveTo(centerX - 5, y);
        ctx.lineTo(centerX + 5, y);
        ctx.stroke();
        ctx.fillText(value, centerX - 8, y);
      }
      
      // 原点标签
      ctx.fillText('0', centerX + 8, centerY + 8);
    }
    
    // 绘制单个函数
    function drawFunction(func, color) {
      const width = canvas.width;
      const height = canvas.height;
      const centerX = width / 2;
      const centerY = height / 2;
      const scale = 50; // 每50像素代表1个单位
      
      ctx.beginPath();
      ctx.strokeStyle = color;
      ctx.lineWidth = 2;
      
      for (let x = 0; x < width; x++) {
        // 将像素坐标转换为数学坐标
        const mathX = (x - centerX) / scale;
        let mathY;
        
        try {
          // 计算函数值，支持常见数学函数
          mathY = eval(func.replace(/x/g, mathX)
                         .replace(/sin/g, 'Math.sin')
                         .replace(/cos/g, 'Math.cos')
                         .replace(/tan/g, 'Math.tan')
                         .replace(/log/g, 'Math.log')
                         .replace(/exp/g, 'Math.exp')
                         .replace(/sqrt/g, 'Math.sqrt')
                         .replace(/\^/g, '**'));
        } catch (e) {
          console.error('函数计算错误:', e);
          alert('函数格式错误，请检查输入！');
          return false;
        }
        
        // 将数学坐标转换为像素坐标
        const pixelY = centerY - mathY * scale;
        
        if (x === 0) {
          ctx.moveTo(x, pixelY);
        } else {
          ctx.lineTo(x, pixelY);
        }
      }
      
      ctx.stroke();
      return true;
    }
    
    // 重绘所有函数
    function redrawAllFunctions() {
      drawAxes();
      functions.forEach((func, index) => {
        drawFunction(func.expression, func.color);
      });
      updateFunctionList();
    }
    
    // 绘制新函数
    function plotFunction() {
      const input = document.getElementById('functionInput');
      const expression = input.value.trim();
      
      if (!expression) return;
      
      // 检查函数是否已存在
      const exists = functions.some(func => func.expression === expression);
      if (exists) {
        alert('此函数已绘制！');
        return;
      }
      
      // 获取颜色（循环使用预设颜色）
      const color = colors[functions.length % colors.length];
      
      // 尝试绘制函数
      const success = drawFunction(expression, color);
      if (success) {
        functions.push({ expression, color });
        input.value = '';
        updateFunctionList();
      }
    }
    
    // 更新函数列表
    function updateFunctionList() {
      const listContainer = document.getElementById('functionList');
      const functionsContainer = listContainer.querySelector('.functions') || document.createElement('div');
      functionsContainer.className = 'functions';
      
      functionsContainer.innerHTML = '';
      
      functions.forEach((func, index) => {
        const funcElement = document.createElement('div');
        funcElement.className = 'function-item';
        
        const colorBox = document.createElement('span');
        colorBox.style.display = 'inline-block';
        colorBox.style.width = '12px';
        colorBox.style.height = '12px';
        colorBox.style.backgroundColor = func.color;
        colorBox.style.marginRight = '8px';
        
        const funcText = document.createElement('span');
        funcText.innerHTML = `f(x) = ${func.expression}`;
        
        const removeBtn = document.createElement('button');
        removeBtn.className = 'remove-function';
        removeBtn.textContent = '×';
        removeBtn.onclick = () => removeFunction(index);
        
        funcElement.appendChild(colorBox);
        funcElement.appendChild(funcText);
        funcElement.appendChild(removeBtn);
        functionsContainer.appendChild(funcElement);
      });
      
      if (!listContainer.querySelector('.functions')) {
        listContainer.appendChild(functionsContainer);
      }
    }
    
    // 移除函数
    function removeFunction(index) {
      functions.splice(index, 1);
      redrawAllFunctions();
    }
    
    // 内容区域切换
    function openSection(sectionId) {
      document.querySelectorAll('.content-section').forEach(sec => {
        sec.style.display = 'none';
      });
      const section = document.getElementById(sectionId);
      if (section) {
        section.style.display = 'block';
      }
    }
    
    // 初始化页面
    document.addEventListener('DOMContentLoaded', () => {
      openSection('yi');
      // 默认绘制sin(x)函数
      plotFunction();
    });
    
    // 太极图标菜单切换（预留功能）
    function toggleMenu() {
      alert('菜单功能待实现');
    }
  </script>
</body>
</html>
